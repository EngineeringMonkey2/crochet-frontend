<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">

  <style>
    body {
      margin: 0;
      font-family: 'Helvetica', 'Arial', sans-serif;
      color: #ffffff;
      background-color: #000000;
      overflow-x: hidden;
    }

    /* Toolbar container */
    .toolbarcontain {
      background-color: rgba(0, 0, 0, 0.6);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 25px 20px;
      box-sizing: border-box;
      transition: top 0.3s ease; /* Added for smooth transition */
    }
    
    .toolbar .cart-link {
        position: relative;
    }
    
    #cart-count {
        position: absolute;
        top: 8px;
        right: 8px;
        background-color: red;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        display: none; /* Hidden by default */
    }

    /* New class to hide the toolbar when scrolling down */
    .toolbar-hidden {
        top: -100px;
    }

    /* Toolbar links */
    .toolbar a {
      color: #ffffff;
      text-align: center;
      padding: 15px 20px;
      text-decoration: none;
      font-size: 20px;
      transition: transform 0.3s ease, color 0.3s ease;
    }

    .hovertext a:hover {
      color: #cccccc;
      transform: scale(1.1);
    }

    .hoverbackground a:hover {
      transform: scale(1.1);
    }

    .leftali, .rightali {
      display: flex;
      align-items: center;
    }

    /* Front section */
    .front {
      height: 100vh;
      width: 100%;
      background-image: url('images/shoppaage-min.png');
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      text-align: center;
      position: relative;
      overflow: hidden;

    }

    /* Padding1 */
    .shoppadding {
      padding-top: 70px;
      position: relative; /* Ensure title appears above the character */
      z-index: 1;
    }




    .front h1 {
      font-size: 48px;
      font-weight: bold;
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    /* Shop section */
    .shop {
      background: linear-gradient(to bottom, #f2e5d9, #d4a5a5);
	  color: black;
      padding: 23px 20px;
      width: 100%;
      box-sizing: border-box;
    }





    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      max-width: 1500px;
      margin: 0 auto;
    }

    .product-card {
      background-color: white;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: column;
    }




    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
	  color: #82569c;
    }

    .product-card .product-image {
      width: 100%;
      height: 300px;
      object-fit: cover;
      cursor: pointer;
    }

    .product-info {
      padding: 15px;
      text-align: center;
      display: flex;
      flex-direction: column;
      flex-grow: 1; /* Allows the info to take up remaining space */
      justify-content: space-between; /* Pushes button to the bottom */
    }

    .product-info h3 {
      margin: 10px 0;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
    }

    .product-info p {
      margin: 5px 0;
      font-size: 16px;
      color: black;
      cursor: pointer;
    }

    /* This container acts as the "canvas" for our character. */
    #character-container {
        position: absolute;
        top: 50%;
        left: 50%;
        /* The width and height are the base for positioning the child elements. */
        /* The actual size is now controlled by a 'transform: scale()' property set by JavaScript. */
        width: 600px;
        height: 900px;
        cursor: pointer;
	    user-select: none; /* Prevent text selection */
    }

    /* Common style for all image parts of the character. */
    /* 'position: absolute' allows us to place them anywhere inside the */
    /* 'character-container' using top, left, right, bottom properties. */
    .character-part {
        position: absolute;
        transition: transform 0.5s ease-in-out; /* Smooth transitions for parts */
		outline: none;
    }

    /* --- POSITIONING RULES --- */
    /* 'z-index' controls the stacking order. Higher numbers are on top. */

    #head {
        top: -40px;
        left: 50px;
        z-index: 10; /* The head is on top of the body and ears. */
    }

    #left-ear {
        top: 100px;
        left: -70px;
        transform: rotate(18deg);
        z-index: 5; /* The ear is behind the head. */
    }

    #right-ear {
        top: 100px;
        left: 515px;
        transform: rotate(-18deg);
        z-index: 5; /* The ear is behind the head. */
    }
    
    /* Animate ears on hover for more life */
    #character-container:hover #left-ear {
        transform: rotate(10deg) translateY(-10px);
    }
    #character-container:hover #right-ear {
        transform: rotate(-10deg) translateY(-10px);
    }


    #body {
        top: 520px;
        left: 150px;
        z-index: 9; /* Behind the head, but in front of arms/legs */
    }

    #left-arm {
        top: 500px;
        left: -145px;
        z-index: 8; /* Behind the body */
    }

    #right-arm {
        top: 500px;
        left: 442px;
        z-index: 8; /* Behind the body */
    }

    #legs {
        top: 800px;
        left: 115px;
        z-index: 8; /* Behind the body */
    }
    
    #tail {
        top: 750px;
        left: 440px;
        z-index: 6; /* Behind the body, same level as legs/arms */
    }


    /* --- Eye Styles --- */
    .eye {
        position: absolute;
        width: 100px;
        height: 80px;
        background: #ffffff;
        border-top: 30px solid #ffffff; 
        border-radius: 50px 50px 50px 50px;
        z-index: 16;
        animation: blink 5s infinite;
		forced-color-adjust: none; /* Add this line */
    }

    #left-eye {
        top: 220px;
        left: 150px;
    }

    #right-eye {
        top: 220px;
        left: 380px;
    }

    .pupil {
        position: absolute;
        width: 90px;
        height: 90px;
        background: black;
        border-radius: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        animation: look-around 7s ease-in-out infinite;
    }
	
	
    .pupilwhiteleft {
        position: absolute;
        width: 20px;
        height: 20px;
        background: white;
        border-radius: 50%;
        left: 30%;
		top: -30%;
        transform: translate(-50%, -50%);
        animation: look-around 7s ease-in-out infinite;
    }
			
    .pupilwhiteright {
        position: absolute;
        width: 20px;
        height: 20px;
        background: white;
        border-radius: 50%;
        left: 30%;
		top: -30%;
        transform: translate(-50%, -50%);
        animation: look-around 7s ease-in-out infinite;
    }
					
	
    
    @keyframes look-around {
        0% { transform: translate(-50%, -50%) translateX(-20px) translateY(10px); }
        15%, 35% { transform: translate(-50%, -50%) translateX(-20px) translateY(10px); }
        40% { transform: translate(-50%, -50%) translateX(10px) translateY(15px); }
        50%, 70% { transform: translate(-50%, -50%) translateX(10px) translateY(15px); }
        75% { transform: translate(-50%, -50%) translateX(-10px) translateY(13px); }
        80%, 100% { transform: translate(-50%, -50%) translateX(-10px) translateY(13px); }
    }

    @keyframes blink {
        0%, 10%, 15%, 100% { transform: scaleY(1); } /* Open */
        12% { transform: scaleY(0.1); } /* Closed */
    }

    /* --- MOUTH STYLES --- */
    #mouth {
        position: absolute;
        z-index: 15; /* Above the head image but below eyes */
        
        /* Unhappy state (frown) */
        width: 110px;
        height: 40px;
        border: 12px solid black;
        border-color: transparent transparent black transparent; /* Bottom border makes the arc */
        border-radius: 0 0 120px 120px / 0 0 60px 60px; /* Creates the frown shape */
        top: 400px; /* Position below the eyes */
        left: 52%;
        transform: translateX(-50%);
        
        /* Smooth transition for all properties */
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }

    #tongue {
        position: absolute;
        width: 50px;
        height: 35px;
        background: #ff8a8a; /* Cute pink tongue color */
        border: 4px solid #000;
        border-radius: 50% 50% 20px 20px; /* Tongue shape */
        bottom: 8px;
        left: 52%;
        transform: translateX(-50%) scaleY(0); /* Hidden by default */
        transform-origin: bottom;
        transition: transform 0.2s ease-in-out 0.1s; /* Delayed transition */
    }

    /* Hover state (Happy smile) */
    #character-container:hover #mouth {
        width: 140px; /* Wider for a big smile */
        height: 60px; /* Slightly taller */
        background: black; /* Dark inside of mouth */
        border: 5px solid #000; /* Black border */
        border-radius: 0 0 120px 120px / 0 0 90px 90px; /* Downward curve for upward smile */
        top: 400px; /* Move mouth up slightly */
        left: 52%;
        transition: transform 0.4s ease-in-out 0.3s; /* Delayed transition */
    }

    #character-container:hover #tongue {
        transform: translateX(-50%) scaleY(1); /* Reveal tongue */
    }

    /* --- Arrow Button Styles --- */
    .arrow-btn {
        position: absolute;
        z-index: 20; /* Make sure arrows are on top */
        width: 50px;
        height: 50px;
        background-color: rgba(255, 255, 255, 0.5);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        border: 2px solid rgba(0,0,0,0.2);
    }

    .arrow-btn:hover {
        background-color: rgba(255, 255, 255, 0.9);
        transform: scale(1.1);
    }
    
    .arrow-btn:active {
        transform: scale(1.0); /* Click effect */
    }
    
    /* Head arrows positioning */
    #prev-head {
        left: 0px; 
        top: 380px; 
    }

    #next-head {
        right: -15px; 
        top: 380px;
    }
    
    /* NEW: Ear arrows positioning */
    #prev-ears {
        left: -110px;
        top: 120px;
    }
    
    #next-ears {
        right: -130px;
        top: 120px;
    }

    /* NEW: Body arrows positioning */
    #prev-body {
        left: 100px;
        top: 650px;
    }
    
    #next-body {
        right: 75px;
        top: 650px;
    }

    /* NEW: Arm arrows positioning */
    #prev-arms {
        left: -200px;
        top: 520px;
    }
    
    #next-arms {
        right: -225px;
        top: 520px;
    }

    /* NEW: Leg arrows positioning */
    #prev-legs {
        left: 50px;
        top: 850px;
    }

    #next-legs {
        right: 50px;
        top: 850px;
    }

    /* NEW: Tail arrows positioning */
    #prev-tail {
        left: 475px;
        top: 730px;
    }
    
    #next-tail {
        right: -30px;
        top: 730px;
    }
    
    /* Responsive design */
    @media (max-width: 800px) {
      .front h1 {
	    padding: 25px;
        font-size: 42px;
      }

      .toolbar a {
        font-size: 15px;
        padding: 10px 5px;
		
      }

      .product-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 30px;
      }

      .product-card img {
        height: 320px;
      }
      
      /* The #character-container is now scaled by JavaScript, so we no longer need a media query for it. */
    }

    /* --- START: ANIME BUTTON STYLES --- */

    /* The Button Container - Positioned Absolute */
    .order-button-container {
        position: absolute; /* Changed from fixed to absolute */
        bottom: 50px;
        right: 30px;
        z-index: 25; /* z-index to be on top of other elements in the container */
    }

    /* The Button */
    .order-button {
        padding: 18px 10px;
        font-size: 28px;
        letter-spacing: 2px;
        color: #000000;
        background: #f5f5dc;
        border: 3px solid #5d4037;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2), inset 0 0 8px rgba(0,0,0,0.1);
        cursor: pointer;
        position: relative;
        overflow: visible; /* Allow particles to go outside */
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-family: 'Fredoka One', cursive; 
        font-weight: bold;
    }

    /* Hover Effect */
    .order-button:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 10px 20px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.1);
    }

    /* Active (Click) Effect */
    .order-button:active {
        transform: translateY(2px) scale(0.95);
    }

    /* Container for all effects */
    .effects-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    /* Individual Particle Styling */
    .particle {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 8px;
        height: 8px;
        background-color: #ffc107;
        border-radius: 50%;
        opacity: 0;
    }
	
	
	
		
		
	/* --- START: Footer Section Styles --- */
	.footer-section {
	  background-color: #ffffff;
	  color: #333;
	  padding: 40px 20px;
	  text-align: center;
	}

	.footer-container {
	  max-width: 1200px;
	  margin: 0 auto;
	  display: flex;
	  justify-content: center;
	  gap: 30px;
	  flex-wrap: wrap;
	}

	.footer-container a {
	  color: #333;
	  text-decoration: none;
	  font-size: 16px;
	  transition: color 0.3s ease;
	}

	.footer-container a:hover {
	  color: #000000;
	  text-decoration: underline;
	}
	/* --- END: Footer Section Styles --- */		
	
		

    /* --- END: ANIME BUTTON STYLES --- */

 /* --- Styles for the interactive cart button --- */
    .add-to-cart-container {
		margin-top: 3px;
        bottom: 15px;
        left: 15px;
    }

    .add-btn {
        background-color: #9FD177;
        color: white;
        border: none;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }

    .add-btn:hover {
        background-color: #425933;
        transform: scale(1.1);
    }

    .quantity-controls {
        display: flex;
        align-items: center;
        background-color: #f0f0f0;
        color: #333;
        border: 1px solid #ddd;
        border-radius: 20px; /* Rounded pill shape */
        padding: 4px;
        width: 90px;
        transition: all 0.3s ease;
    }

    .quantity-controls .quantity-btn {
        background: white;
        border: 1px solid #ccc;
        color: #333;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        border-radius: 50%;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s;
        padding: 5px;
    }

    .quantity-controls .quantity-btn:hover {
        background-color: #e9e9e9;
    }
    
    .quantity-controls .minus-btn svg {
        pointer-events: none; /* Ensures click is registered on the button */
    }

    .quantity-controls .quantity {
        font-size: 16px;
        font-weight: bold;
        min-width: 25px;
        text-align: center;
        padding: 0 5px;
    }

  </style>
	<link rel="icon" type="image/png" href="images/tabphoto-min.png">
  <!-- Font for Anime Button -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
</head>
<body>
  <div class="toolbarcontain">
    <div class="hovertext">
      <div class="leftali">
        <div class="toolbar">
          <a href="index.html">Home</a>
          <a href="#shop">Shop</a>
          <a href="#Build Your Monkey">Build</a>
          <a href="contact.html">Contact</a>
        </div>
      </div>
    </div>
    <div class="rightali">
      <div class="hoverbackground">
        <div class="toolbar">
		
		
			<a href="login.html" class="user-link">
				<img src="images/Icons/User-min.png" alt="User" style="height:20px; vertical-align:middle;">
			</a>		
				
		
		
          <a href="cart.html" class="cart-link">
            <img src="images/Icons/ShoppingBag-min.png" alt="Shopping Bag" style="height:20px; vertical-align:middle;">
            <span id="cart-count">0</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="front" id="Build Your Monkey" >
	<div class="shoppadding">
		<h1>Build Your Monkey</h1>
	</div>
	    
    <div id="character-container">
        
        <div id="prev-head" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-head" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>
        
        <div id="prev-ears" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-ears" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>

        <div id="prev-body" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-body" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>

        <div id="prev-arms" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-arms" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>

        <div id="prev-legs" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-legs" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>
        
        <div id="prev-tail" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </div>
        <div id="next-tail" class="arrow-btn">
            <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        </div>

        <img id="head" class="character-part" src="" alt="Character Head">
        <img id="left-ear" class="character-part" src="" alt="Left Ear">
        <img id="right-ear" class="character-part" src="" alt="Right Ear">
        <img id="body" class="character-part" src="" alt="Character Body">
        <img id="left-arm" class="character-part" src="" alt="Left Arm">
        <img id="right-arm" class="character-part" src="" alt="Right Arm">
        <img id="legs" class="character-part" src="" alt="Legs">
        <img id="tail" class="character-part" src="" alt="Tail">

        <div id="left-eye" class="eye">
            <div class="pupil"></div>
            <div class="pupilwhiteleft"></div>
        </div>
        <div id="right-eye" class="eye">
            <div class="pupil"></div>
            <div class="pupilwhiteright"></div>
        </div>
        
        <div id="mouth">
            <div id="tongue"></div>
        </div>
    </div>
    
    <!-- START: ANIME BUTTON HTML -->
    <div class="order-button-container" id="buttonContainer">
        <button class="order-button" id="orderButton">
            Order Now!
            <div class="effects-container" id="effectsContainer"></div>
        </button>
    </div>
    <!-- END: ANIME BUTTON HTML -->

  </div>

  <div class="shop" id="shop">
    <h1>Products</h1>
    <div class="product-grid" id="product-grid">
      <!-- Products will be injected here by JavaScript -->
    </div>
  </div>
  
  
  <div class="footer-section">
      <div class="footer-container">
	    <a href="aboutus.html">About Us</a>

        <a href="privacypolicy.html">Privacy Policy</a>
        <a href="contact.html">Contact Information</a>
        <a href="returnpolicy.html">Refund Policy</a>
        <a href="shippingpolicy.html">Shipping Policy</a>
		
      </div>
  </div>

  
  <script src="cart.js"></script>
  <script src="products.js"></script>
  <script>
    // Wait for the document to be fully loaded before running the script
    document.addEventListener('DOMContentLoaded', () => {
        
        const productGrid = document.getElementById('product-grid');

        // Function to render products
        function renderProducts() {
            productGrid.innerHTML = '';
            const cart = getCart();

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.classList.add('product-card');
                productCard.dataset.productId = product.id; // Add product id to the card

                const imageUrl = product.image || (product.images && product.images[0]);
                const itemInCart = cart.find(item => item.id === product.id);

                const quantity = itemInCart ? itemInCart.quantity : 0;
                const addBtnDisplay = quantity > 0 ? 'none' : 'block';
                const controlsDisplay = quantity > 0 ? 'flex' : 'none';

                productCard.innerHTML = `
                    <img src="${imageUrl}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div>
                            <h3>${product.name}</h3>
                            <p>${product.price}</p>
                        </div>
                        <div class="add-to-cart-container">
                            <button class="add-btn" style="display: ${addBtnDisplay};">+</button>
                            <div class="quantity-controls" style="display: ${controlsDisplay};">
                                <button class="quantity-btn minus-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                                        <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                                    </svg>
                                </button>
                                <span class="quantity">${quantity}</span>
                                <button class="quantity-btn plus-btn">+</button>
                            </div>
                        </div>
                    </div>
                `;
                productGrid.appendChild(productCard);
            });
        }

        // Event listener for the entire product grid (event delegation)
        productGrid.addEventListener('click', (e) => {
            const productCard = e.target.closest('.product-card');
            if (!productCard) return;

            const productId = parseInt(productCard.dataset.productId);
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const addBtn = productCard.querySelector('.add-btn');
            const controls = productCard.querySelector('.quantity-controls');
            const quantitySpan = productCard.querySelector('.quantity');

            // Handle clicking "Add to cart"
            if (e.target.classList.contains('add-btn')) {
                const item = {
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image || (product.images && product.images[0]),
                    quantity: 1
                };
                addToCart(item);
                showToast(`${product.name} added to cart!`);

                addBtn.style.display = 'none';
                controls.style.display = 'flex';
                quantitySpan.textContent = '1';
                return; // Stop further actions
            }

            // Handle clicking "+"
            if (e.target.classList.contains('plus-btn')) {
                const cart = getCart();
                const itemIndex = cart.findIndex(item => item.id === productId);
                if (itemIndex > -1) {
                    updateQuantity(itemIndex, 1);
                    // Re-fetch cart to get the updated quantity
                    const updatedCart = getCart();
                    quantitySpan.textContent = updatedCart[itemIndex].quantity;
                    updateCartIcon();
                }
                return; // Stop further actions
            }

            // Handle clicking the trash can "-"
            if (e.target.classList.contains('minus-btn') || e.target.closest('.minus-btn')) {
                const cart = getCart();
                const itemIndex = cart.findIndex(item => item.id === productId);
                if (itemIndex > -1) {
                    updateQuantity(itemIndex, -1);
                    const updatedCart = getCart(); // Get cart again after potential removal
                    const updatedItem = updatedCart.find(item => item.id === productId);
                    
                    if (updatedItem) {
                        quantitySpan.textContent = updatedItem.quantity;
                    } else {
                        // Item was removed from cart
                        addBtn.style.display = 'block';
                        controls.style.display = 'none';
                    }
                    updateCartIcon();
                }
                return; // Stop further actions
            }

            // If none of the buttons were clicked, navigate to the product page
            window.location.href = `product.html?productId=${product.id}`;
        });


        // --- Combined Scroll Logic ---
        let lastScrollTop = 0;
        const toolbar = document.querySelector('.toolbarcontain');

        window.addEventListener('scroll', function() {
          // Original animation on scroll for product cards
          const shopSection = document.querySelector('.shop');
          const productCards = document.querySelectorAll('.product-card');
          const sectionTop = shopSection.getBoundingClientRect().top;
          const windowHeight = window.innerHeight;

          if (sectionTop < windowHeight * 0.75) {
            productCards.forEach((card, index) => {
              setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
              }, index * 100);
            });
          }

          // --- New logic for toolbar visibility ---
          let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          if (scrollTop > lastScrollTop) {
              // Downscroll code
              toolbar.classList.add('toolbar-hidden');
          } else {
              // Upscroll code
              toolbar.classList.remove('toolbar-hidden');
          }
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
        });
        
        // --- Monkey Builder and Scaling Logic (Unchanged) ---
        const characterContainer = document.getElementById('character-container');
        characterContainer.style.transition = 'transform 0.3s ease'; 
        let baseScale = 1;

		function getDynamicMultiplier(currentSize, minSize, maxSize, maxMultiplier, minMultiplier) {
			if (currentSize <= minSize) return maxMultiplier;
			if (currentSize >= maxSize) return minMultiplier;
			const progress = (currentSize - minSize) / (maxSize - minSize);
			const easedProgress = Math.pow(progress, 2);
			return maxMultiplier - (easedProgress * (maxMultiplier - minMultiplier));
		}

		function updateMonkeyScale() {
			const MIN_SCREEN_WIDTH = 320, MAX_SCREEN_WIDTH = 1920;
			const MIN_SCREEN_HEIGHT = 480, MAX_SCREEN_HEIGHT = 1080;
			const MAX_WIDTH_MULTIPLIER = 0.5, MIN_WIDTH_MULTIPLIER = 0.40;
			const MAX_HEIGHT_MULTIPLIER = 0.80, MIN_HEIGHT_MULTIPLIER = 0.65;

			const widthMultiplier = getDynamicMultiplier(window.innerWidth, MIN_SCREEN_WIDTH, MAX_SCREEN_WIDTH, MAX_WIDTH_MULTIPLIER, MIN_WIDTH_MULTIPLIER);
			const heightMultiplier = getDynamicMultiplier(window.innerHeight, MIN_SCREEN_HEIGHT, MAX_SCREEN_HEIGHT, MAX_HEIGHT_MULTIPLIER, MIN_HEIGHT_MULTIPLIER);

			const targetWidth = window.innerWidth * widthMultiplier;
			const targetHeight = window.innerHeight * heightMultiplier;

			let scaleBasedOnHeight = targetHeight / 900;
			let scaleBasedOnWidth = targetWidth / 600;

			baseScale = Math.min(scaleBasedOnHeight, scaleBasedOnWidth);
			characterContainer.style.transform = `translate(-50%, -50%) scale(${baseScale})`;
		}

        characterContainer.addEventListener('mouseenter', () => {
            const hoverScale = baseScale * 1.03;
            characterContainer.style.transform = `translate(-50%, -50%) scale(${hoverScale})`;
        });

        characterContainer.addEventListener('mouseleave', () => {
            characterContainer.style.transform = `translate(-50%, -50%) scale(${baseScale})`;
        });

        window.addEventListener('resize', updateMonkeyScale);

        // --- Character Part Changers (Unchanged) ---
        const headImage = document.getElementById('head');
        const prevHeadButton = document.getElementById('prev-head');
        const nextHeadButton = document.getElementById('next-head');
        const headImages = ['images/Anime/BuildingTemplate/01-Head/Heads/Head1-min.png', 'images/Anime/BuildingTemplate/01-Head/Heads/Head2-min.png', 'images/Anime/BuildingTemplate/01-Head/Heads/Head3-min.png', 'images/Anime/BuildingTemplate/01-Head/Heads/Head4-min.png', 'images/Anime/BuildingTemplate/01-Head/Heads/Head5-min.png', 'images/Anime/BuildingTemplate/01-Head/Heads/Head6-min.png'];
        let currentHeadIndex = 0;
        function updateHead() { headImage.src = headImages[currentHeadIndex]; }

        const leftEarImage = document.getElementById('left-ear');
        const rightEarImage = document.getElementById('right-ear');
        const prevEarsButton = document.getElementById('prev-ears');
        const nextEarsButton = document.getElementById('next-ears');
        const earImages = [{ left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar1-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar1-min.png' }, { left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar2-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar2-min.png' }, { left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar3-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar3-min.png' }, { left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar4-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar4-min.png' }, { left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar5-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar5-min.png' }, { left: 'images/Anime/BuildingTemplate/04-Ears/Ears/LeftEar6-min.png', right: 'images/Anime/BuildingTemplate/04-Ears/Ears/RightEar6-min.png' }];
        let currentEarIndex = 0;
        function updateEars() { const earPair = earImages[currentEarIndex]; leftEarImage.src = earPair.left; rightEarImage.src = earPair.right; }

        const bodyImage = document.getElementById('body');
        const prevBodyButton = document.getElementById('prev-body');
        const nextBodyButton = document.getElementById('next-body');
        const bodyImages = ['images/Anime/BuildingTemplate/05-Body/Bodies/Body1-min.png', 'images/Anime/BuildingTemplate/05-Body/Bodies/Body2-min.png', 'images/Anime/BuildingTemplate/05-Body/Bodies/Body3-min.png', 'images/Anime/BuildingTemplate/05-Body/Bodies/Body4-min.png', 'images/Anime/BuildingTemplate/05-Body/Bodies/Body5-min.png', 'images/Anime/BuildingTemplate/05-Body/Bodies/Body6-min.png'];
        let currentBodyIndex = 0;
        function updateBody() { bodyImage.src = bodyImages[currentBodyIndex]; }

        const leftArmImage = document.getElementById('left-arm');
        const rightArmImage = document.getElementById('right-arm');
        const prevArmsButton = document.getElementById('prev-arms');
        const nextArmsButton = document.getElementById('next-arms');
        const armImages = [{ left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm1-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm1-min.png' }, { left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm2-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm2-min.png' }, { left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm3-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm3-min.png' }, { left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm4-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm4-min.png' }, { left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm5-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm5-min.png' }, { left: 'images/Anime/BuildingTemplate/06-Arms/Arms/LeftArm6-min.png', right: 'images/Anime/BuildingTemplate/06-Arms/Arms/RightArm6-min.png' }];
        let currentArmIndex = 0;
        function updateArms() { const armPair = armImages[currentArmIndex]; leftArmImage.src = armPair.left; rightArmImage.src = armPair.right; }

        const legsImage = document.getElementById('legs');
        const prevLegsButton = document.getElementById('prev-legs');
        const nextLegsButton = document.getElementById('next-legs');
        const legImages = ['images/Anime/BuildingTemplate/07-Legs/Legs/Legs1-min.png', 'images/Anime/BuildingTemplate/07-Legs/Legs/Legs2-min.png', 'images/Anime/BuildingTemplate/07-Legs/Legs/Legs3-min.png', 'images/Anime/BuildingTemplate/07-Legs/Legs/Legs4-min.png', 'images/Anime/BuildingTemplate/07-Legs/Legs/Legs5-min.png', 'images/Anime/BuildingTemplate/07-Legs/Legs/Legs6-min.png'];
        let currentLegIndex = 0;
        function updateLegs() { legsImage.src = legImages[currentLegIndex]; }

        const tailImage = document.getElementById('tail');
        const prevTailButton = document.getElementById('prev-tail');
        const nextTailButton = document.getElementById('next-tail');
        const tailImages = ['images/Anime/BuildingTemplate/08-Tail/Tails/Tail1-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail2-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail3-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail4-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail5-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail6-min.png', 'images/Anime/BuildingTemplate/08-Tail/Tails/Tail7-min.png'];
        let currentTailIndex = 0;
        function updateTail() { tailImage.src = tailImages[currentTailIndex]; }

        // --- Event Listeners for Monkey Builder (Unchanged) ---
        nextHeadButton.addEventListener('click', (event) => { event.stopPropagation(); currentHeadIndex = (currentHeadIndex + 1) % headImages.length; updateHead(); });
        prevHeadButton.addEventListener('click', (event) => { event.stopPropagation(); currentHeadIndex = (currentHeadIndex - 1 + headImages.length) % headImages.length; updateHead(); });
        nextEarsButton.addEventListener('click', (event) => { event.stopPropagation(); currentEarIndex = (currentEarIndex + 1) % earImages.length; updateEars(); });
        prevEarsButton.addEventListener('click', (event) => { event.stopPropagation(); currentEarIndex = (currentEarIndex - 1 + earImages.length) % earImages.length; updateEars(); });
        nextBodyButton.addEventListener('click', (event) => { event.stopPropagation(); currentBodyIndex = (currentBodyIndex + 1) % bodyImages.length; updateBody(); });
        prevBodyButton.addEventListener('click', (event) => { event.stopPropagation(); currentBodyIndex = (currentBodyIndex - 1 + bodyImages.length) % bodyImages.length; updateBody(); });
        nextArmsButton.addEventListener('click', (event) => { event.stopPropagation(); currentArmIndex = (currentArmIndex + 1) % armImages.length; updateArms(); });
        prevArmsButton.addEventListener('click', (event) => { event.stopPropagation(); currentArmIndex = (currentArmIndex - 1 + armImages.length) % armImages.length; updateArms(); });
        nextLegsButton.addEventListener('click', (event) => { event.stopPropagation(); currentLegIndex = (currentLegIndex + 1) % legImages.length; updateLegs(); });
        prevLegsButton.addEventListener('click', (event) => { event.stopPropagation(); currentLegIndex = (currentLegIndex - 1 + legImages.length) % legImages.length; updateLegs(); });
        nextTailButton.addEventListener('click', (event) => { event.stopPropagation(); currentTailIndex = (currentTailIndex + 1) % tailImages.length; updateTail(); });
        prevTailButton.addEventListener('click', (event) => { event.stopPropagation(); currentTailIndex = (currentTailIndex - 1 + tailImages.length) % tailImages.length; updateTail(); });
        
        // --- Order Button Logic (Unchanged) ---
        const orderButton = document.getElementById('orderButton');
        orderButton.addEventListener('click', (e) => {
            const partsToSave = ['head', 'left-ear', 'right-ear', 'body', 'left-arm', 'right-arm', 'legs', 'tail'];
            const params = new URLSearchParams();
            partsToSave.forEach(partId => {
                const imageElement = document.getElementById(partId);
                if (imageElement) {
                    params.append(partId, encodeURIComponent(imageElement.src));
                }
            });
            window.location.href = `customizationproduct.html?${params.toString()}`;
        });

        // --- Initial Setup Calls ---
        renderProducts();
        updateMonkeyScale();
        updateHead();
        updateEars();
        updateBody();
        updateArms();
        updateLegs();
        updateTail();
    });
  </script>
</body>
</html>
